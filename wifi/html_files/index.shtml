<!DOCTYPE html>
<html>
  <head>
    <title>Max Verstappen</title>
    <style>
      body {
        font-family: "Helvetica", "Arial", sans-serif;
        background-color: #eeeeee;
      }

      .container {
        display: flex;
      }
      .left-column {
        flex: 2; /* Adjust the width of the left column as needed */
        padding: 10px;
      }
      .map {
        flex: 1; /* The map occupies 1/3 of the container width */
        border: 1px solid #ccc;
        padding: 10px;
        box-sizing: border-box;
      }
      .controls {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }
      .button {
        display: block;
        padding: 10px;
        text-align: center;
        background-color: #007bff;
        color: #fff;
        text-decoration: none;
        border-radius: 22px;
        cursor: pointer;
        margin-bottom: 10px; /* Add margin to create a gap between buttons */
      }
      .button:hover {
        background-color: #0044ff;
      }
      .data {
        margin-top: 10px;
      }
      .grid {
        display: grid;
      }

      .grid-row {
        margin: 0;
        padding: 0;
      }

      .grid-cell {
        position: relative;
      }

      .grid-cell::before {
        content: "";
        display: block;
        padding-top: 100%;
      }

      .grid-cell-content {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
      }
    </style>
  </head>
  <body>
    <h1>Welcome To Red Bull Racing üèéÔ∏è</h1>
    <div class="container">
      <div class="left-column">
        <div class="controls">
          <h2>Led Controls:</h2>
          <a onclick="toggleLed(1)" class="button">ON LED</a>
          <a onclick="toggleLed(0)" class="button">OFF LED</a>
          <a href="/index.shtml" class="button">Refresh</a>
        </div>
        <div class="controls">
          <h2>Engine Controls:</h2>
          <a onclick="toggleEngine(1)" class="button">Start Car</a>
          <a onclick="toggleEngine(0)" class="button">Stop Car</a>
          <a href="/index.shtml" class="button">Refresh</a>
        </div>
        <div class="data">
          <h2>SSI Data:</h2>
          <p id="car-status">
            Car Voltage:
            <!--#volt-->
          </p>
          <p id="temperature-status">
            Car Engine Temperature:
            <!--#temp-->
            C
          </p>
          <p id="led-status">
            Car is switched:
            <!--#led-->
          </p>
        </div>
      </div>
      <div class="map">
        <!-- Add your map image here -->
        <input
          type="hidden"
          id="max-width"
          name="max-width"
          value="<!--#width-->"
        />
        <input
          type="hidden"
          id="max-height"
          name="max-height"
          value="<!--#height-->"
        />
        <div class="grid"></div>
        <!-- <img
          src="/assets/route.png"
          alt="Route Map"
          style="width: 100%; max-width: 100%; height: auto"
        /> -->
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const max_width = document.getElementById("max-width").value;
        const max_height = document.getElementById("max-height").value;
        var gridContainer = document.querySelector(".grid");
        gridContainer.style.gridTemplateColumns = `repeat(${max_width}, 1fr)`;
        const grid_data = "<!--#gridmap-->";
        const json_grid_data = JSON.parse(grid_data.replace(/'/g, '"'));

        const total_cells = max_height * max_width;

        var current_x;
        var current_y;
        var wall_details;

        for (var i = 0; i < total_cells; i++) {
          var cell = document.createElement("div"); // Create a new div for each cell
          cell.className = "grid-cell"; // Assign class name to the cell

          current_x = i % max_width;
          current_y = Math.floor(i / max_width);

          var item = json_grid_data.find(function (element) {
            return element.x === current_x && element.y === current_y;
          });

          if (item) {
            if (item.n === 1) {
              cell.style.borderTop = "1px solid green";
            }
            if (item.s === 1) {
              cell.style.borderBottom = "1px solid green";
            }
            if (item.e === 1) {
              cell.style.borderRight = "1px solid green";
            }
            if (item.w === 1) {
              cell.style.borderLeft = "1px solid green";
            }
          }
          var content = document.createElement("div");
          content.className = "grid-cell-content"; // For barcode

          cell.appendChild(content);

          gridContainer.appendChild(cell); // Append the cell to the grid container
        }
      });

      function toggleLed(status) {
        // Make an AJAX request to the server
        fetch(`/led.cgi?led=${status}`)
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.text();
          })
          .then((html) => {
            console.log("LED status changed.");
            // Update LED status
            document.getElementById(
              "led-status"
            ).innerHTML = `Car is switched: ${status ? "ON" : "OFF"}`;
          })
          .catch((error) => {
            console.error(
              "There has been a problem with your fetch operation:",
              error
            );
          });
      }

      function toggleEngine(status) {
        // Make an AJAX request to the server
        fetch(`/engine.cgi?engine=${status}`)
          .then((response) => {
            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            return response.text();
          })
          .then((html) => {
            console.log("Engine status changed.");
          })
          .catch((error) => {
            console.error(
              "There has been a problem with your fetch operation:",
              error
            );
          });
      }
    </script>
  </body>
</html>
